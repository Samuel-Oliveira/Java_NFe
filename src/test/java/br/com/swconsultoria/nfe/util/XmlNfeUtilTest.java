package br.com.swconsultoria.nfe.util;

import br.com.swconsultoria.nfe.Validar;
import br.com.swconsultoria.nfe.dom.enuns.ServicosEnum;
import org.junit.jupiter.api.Test;

import java.io.FileNotFoundException;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.security.NoSuchAlgorithmException;

import static org.junit.jupiter.api.Assertions.*;

/**
 * @author Samuel Oliveira - samuk.exe@hotmail.com Data: 26/05/2019 - 12:38
 */
class XmlNfeUtilTest {

    @Test
    public void validarXmlNfeProc() {
        final String xml1 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><nfeProc versao=\"4.00\" xmlns=\"http://www.portalfiscal.inf.br/nfe\"><NFe xmlns=\"http://www.portalfiscal.inf.br/nfe\"><infNFe versao=\"4.00\" Id=\"NFe52230309158456010159550010000731761567812345\"><ide><cUF>52</cUF><cNF>56781234</cNF><natOp>Venda de Comb. Congenere</natOp><mod>55</mod><serie>1</serie><nNF>73179</nNF><dhEmi>2023-03-21T11:30:57-03:00</dhEmi><dhSaiEnt>2023-03-21T11:30:00-03:00</dhSaiEnt><tpNF>1</tpNF><idDest>1</idDest><cMunFG>5220454</cMunFG><tpImp>1</tpImp><tpEmis>1</tpEmis><cDV>5</cDV><tpAmb>1</tpAmb><finNFe>1</finNFe><indFinal>0</indFinal><indPres>0</indPres><procEmi>0</procEmi><verProc>9.21.5</verProc></ide><emit><CNPJ>09158456000159</CNPJ><xNome>PHOENIX DIST DE COMBUSTIVEIS LTDA</xNome><xFant>PHOENIX DIST DE COMBUSTIVEIS LTDA</xFant><enderEmit><xLgr>AV TROPICAL S/NR QD. MOD, LT. 8, BLC. B, SL. 04</xLgr><nro>0</nro><xBairro>DISTR IND BRASIL CENTRAL</xBairro><cMun>5220454</cMun><xMun>SENADOR CANEDO</xMun><UF>GO</UF><CEP>75251722</CEP><cPais>1058</cPais><xPais>BRASIL</xPais><fone>6235124426</fone></enderEmit><IE>104282215</IE><CRT>3</CRT></emit><dest><CNPJ>08944957000360</CNPJ><xNome>PETROWORLD COMBUSTIVEIS S/A</xNome><enderDest><xLgr>AV. TROPICAL, LT. 05/06 A, SALA 25</xLgr><nro>0</nro><xBairro>DISTR INDL BR CENTRAL</xBairro><cMun>5220454</cMun><xMun>SENADOR CANEDO</xMun><UF>GO</UF><CEP>75251722</CEP><cPais>1058</cPais><xPais>BRASIL</xPais><fone>6236228077</fone></enderDest><indIEDest>1</indIEDest><IE>107680335</IE></dest><det nItem=\"1\"><prod><cProd>3301</cProd><cEAN>SEM GTIN</cEAN><xProd>OLEO DIESEL A S-500</xProd><NCM>27101921</NCM><CEST>0600600</CEST><CFOP>5655</CFOP><uCom>L</uCom><qCom>47878.0000</qCom><vUnCom>5.0139000000</vUnCom><vProd>240055.50</vProd><cEANTrib>SEM GTIN</cEANTrib><uTrib>L</uTrib><qTrib>47878.0000</qTrib><vUnTrib>5.0139000000</vUnTrib><indTot>1</indTot><comb><cProdANP>420102004</cProdANP><descANP>OLEO DIESEL A S-500</descANP><qTemp>47878.0000</qTemp><UFCons>GO</UFCons></comb></prod><imposto><ICMS><ICMSST><orig>0</orig><CST>60</CST><vBCSTRet>0.00</vBCSTRet><vICMSSTRet>0.00</vICMSSTRet><vBCSTDest>322990.30</vBCSTDest><vICMSSTDest>45218.64</vICMSSTDest></ICMSST></ICMS><IPI><cEnq>999</cEnq><IPINT><CST>53</CST></IPINT></IPI><PIS><PISNT><CST>04</CST></PISNT></PIS><COFINS><COFINSNT><CST>04</CST></COFINSNT></COFINS></imposto><infAdProd>- Produto Retirado na DINAMICA TERMINAIS CANEDO S/A - AV TROPICAL SNR MODULO 06B - DISTR INDL BR CENTRAL - SENADOR CANEDO - GO - CNPJ: 33.047.181/0001-60 - Pedido = 5664401 - Qtde 20 graus: 47.821 litros; - Formulario seguranca:5664401; - Numero Boletim de Conformidade = 67/2023; - Base ICMS Origem = 322.990,30 - Valor = 45.218,64;</infAdProd></det><total><ICMSTot><vBC>0.00</vBC><vICMS>0.00</vICMS><vICMSDeson>0.00</vICMSDeson><vFCP>0.00</vFCP><vBCST>0.00</vBCST><vST>0.00</vST><vFCPST>0.00</vFCPST><vFCPSTRet>0.00</vFCPSTRet><vProd>240055.50</vProd><vFrete>0.00</vFrete><vSeg>0.00</vSeg><vDesc>0.00</vDesc><vII>0.00</vII><vIPI>0.00</vIPI><vIPIDevol>0.00</vIPIDevol><vPIS>0.00</vPIS><vCOFINS>0.00</vCOFINS><vOutro>0.00</vOutro><vNF>240055.50</vNF></ICMSTot></total><transp><modFrete>1</modFrete><transporta><CNPJ>09158456000310</CNPJ><xNome>PROPRIO</xNome><IE>107780828</IE><xEnder>AV TROPICAL MODULO 6B , BLOCO A SALA 16</xEnder><xMun>SENADOR CANEDO</xMun><UF>GO</UF></transporta><veicTransp><placa>AAA0000</placa><UF>GO</UF></veicTransp><vol><qVol>47878</qVol><marca>PHOENIX</marca><nVol>1</nVol><pesoL>40170.000</pesoL><pesoB>40170.000</pesoB><lacres><nLacre>0086434</nLacre></lacres></vol></transp><cobr><fat><nFat>073179</nFat><vOrig>240055.50</vOrig><vDesc>0.00</vDesc><vLiq>240055.50</vLiq></fat><dup><nDup>001</nDup><dVenc>2023-03-21</dVenc><vDup>240055.50</vDup></dup></cobr><pag><detPag><tPag>15</tPag><vPag>240055.50</vPag></detPag></pag><infAdic><infCpl>- Declaramos que os Produtos estao adequadamente acondicionados para as Normas de Carregamento, Descarregamento, Transbordo e Transporte, conforme Regulamentacao em Vigor. - Produto Retirado na DINAMICA TERMINAIS CANEDO S/A - AV TROPICAL SNR MODULO 06B - DISTR INDL BR CENTRAL - SENADOR CANEDO - GO - CNPJ: 33.047.181/0001-60 - Nome Motorista: VENDA CONGENERE PHOENIX - PETROWORLD - Placas: GO AAA-0000 - Pedido = 5664401 - Lacres = Azul 0086434; - Numero Boletim de Conformidade = 67/2023;</infCpl></infAdic><infRespTec><CNPJ>18406978000113</CNPJ><xContato>Ubaltino Faleiro</xContato><email>ubaltino@sistemainteligente.com</email><fone>62992887101</fone></infRespTec></infNFe><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"></CanonicalizationMethod><SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"></SignatureMethod><Reference URI=\"#NFe52230309158456000159550010000731791567812345\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"></Transform><Transform Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"></Transform></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"></DigestMethod><DigestValue>prmbdxKA/lyJ5RkjcliNkqY14nA=</DigestValue></Reference></SignedInfo><SignatureValue>YLElEQYakJPKh4oChHkSkfqFtRro2l2y3kN4wPiQbncv1EVFIn/PPrD/mi9GPF9U2g1SoHzYeNHR20QvhdyjcUF+DkgmHwT/SCvx89d0Q6ui3Gm5rggaCXw2MY7H99oxXMfT3OMKDCgCskiiHlTf9cCNF985BHs8y+j6yeDrZltAlrThq47xhET4I3xyBXlMlYWqvlnem/LN4eaVXAxCvkryzJCaFS+wtPJTEASWMz0mb1JT3VpYNvvcjFTH2PymY8x0wfvlP/bhlzPadiJ+BGKZ1971z3m+svJzX3wCZgw0Log/hjTyiRRQwqnwBbM+BHc8YDnuOY7ZqiHznbE/RA==</SignatureValue><KeyInfo><X509Data><X509Certificate>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</X509Certificate></X509Data></KeyInfo></Signature></NFe><protNFe versao=\"4.00\"><infProt><tpAmb>1</tpAmb><verAplic>GO4.0</verAplic><chNFe>52230309158456000159550010000731791567812345</chNFe><dhRecbto>2023-03-21T11:31:00-03:00</dhRecbto><nProt>152236109643154</nProt><digVal>prmbdxKA/lyJ5RkjcliNkqY14nA=</digVal><cStat>100</cStat><xMotivo>Autorizado o uso da NF-e</xMotivo></infProt></protNFe></nfeProc>";
        final String xml2 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><nfeProc versao=\"4.00\" xmlns=\"http://www.portalfiscal.inf.br/nfe\"><NFe xmlns=\"http://www.portalfiscal.inf.br/nfe\"><infNFe versao=\"4.00\" Id=\"NFe43230489548223000180550100004329571146119231\"><ide><cUF>43</cUF><cNF>17611923</cNF><natOp>Venda</natOp><mod>55</mod><serie>10</serie><nNF>432957</nNF><dhEmi>2023-04-12T10:59:49-03:00</dhEmi><tpNF>1</tpNF><idDest>1</idDest><cMunFG>4318705</cMunFG><tpImp>1</tpImp><tpEmis>1</tpEmis><cDV>1</cDV><tpAmb>1</tpAmb><finNFe>1</finNFe><indFinal>0</indFinal><indPres>9</indPres><indIntermed>0</indIntermed><procEmi>0</procEmi><verProc>4.00</verProc></ide><emit><CNPJ>89548523000180</CNPJ><xNome>ALISUL ALIMENTOS S.A. - SAO LEOPOLDO</xNome><xFant>ALISUL ALIMENTOS S.A.</xFant><enderEmit><xLgr>AV JOAO CARLOS HOHENDORFF</xLgr><nro>NR 900</nro><xBairro>ARROIO DA MANTEIGA</xBairro><cMun>4318705</cMun><xMun>SAO LEOPOLDO</xMun><UF>RS</UF><CEP>93135400</CEP><cPais>1058</cPais><xPais>BRASIL</xPais><fone>5121231400</fone></enderEmit><IE>1240047077</IE><CRT>3</CRT></emit><dest><CNPJ>18863437000114</CNPJ><xNome>EVERTON PAULO ALVES AGROPEC</xNome><enderDest><xLgr>RUA DJALMO HAACK</xLgr><nro>NR 748</nro><xBairro>ALEXANDRIA</xBairro><cMun>4314050</cMun><xMun>PAROBE</xMun><UF>RS</UF><CEP>95630000</CEP><cPais>1058</cPais><xPais>BRASIL</xPais><fone>5135434027</fone></enderDest><indIEDest>1</indIEDest><IE>2410071133</IE><email>EVERTON@EVERTON.COM.BR</email></dest><det nItem=\"1\"><prod><cProd>987E10.1</cProd><cEAN>7896803078888</cEAN><xProd>SAPECA PEQUENAS RACAS SC 10,1KG</xProd><NCM>23099010</NCM><CEST>2200100</CEST><EXTIPI>01</EXTIPI><CFOP>5401</CFOP><uCom>SC</uCom><qCom>20.0000</qCom><vUnCom>59.7663000000</vUnCom><vProd>1195.33</vProd><cEANTrib>7896803078888</cEANTrib><uTrib>SC</uTrib><qTrib>20.0000</qTrib><vUnTrib>59.7663000000</vUnTrib><vFrete>31.91</vFrete><indTot>1</indTot></prod><imposto><vTotTrib>453.65</vTotTrib><ICMS><ICMS10><orig>0</orig><CST>10</CST><modBC>1</modBC><vBC>1227.24</vBC><pICMS>17.0000</pICMS><vICMS>208.63</vICMS><modBCST>4</modBCST><pMVAST>72.2800</pMVAST><vBCST>2114.29</vBCST><pICMSST>17.0000</pICMSST><vICMSST>150.80</vICMSST></ICMS10></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>50</CST><vBC>1195.33</vBC><pIPI>0.0000</pIPI><vIPI>0.00</vIPI></IPITrib></IPI><PIS><PISAliq><CST>01</CST><vBC>1018.60</vBC><pPIS>1.6500</pPIS><vPIS>16.81</vPIS></PISAliq></PIS><COFINS><COFINSAliq><CST>01</CST><vBC>1018.60</vBC><pCOFINS>7.6000</pCOFINS><vCOFINS>77.41</vCOFINS></COFINSAliq></COFINS></imposto><infAdProd>Valor Aproximado dos Tributos - R$453.65.</infAdProd></det><det nItem=\"2\"><prod><cProd>986E10.1</cProd><cEAN>7896803077522</cEAN><xProd>SAPECA ADULTOS SC 10.1KG</xProd><NCM>23099010</NCM><CEST>2200100</CEST><EXTIPI>01</EXTIPI><CFOP>5401</CFOP><uCom>SC</uCom><qCom>15.0000</qCom><vUnCom>53.0301000000</vUnCom><vProd>795.45</vProd><cEANTrib>7896803077522</cEANTrib><uTrib>SC</uTrib><qTrib>15.0000</qTrib><vUnTrib>53.0301000000</vUnTrib><vFrete>23.93</vFrete><indTot>1</indTot></prod><imposto><vTotTrib>302.89</vTotTrib><ICMS><ICMS10><orig>0</orig><CST>10</CST><modBC>1</modBC><vBC>819.38</vBC><pICMS>17.0000</pICMS><vICMS>139.29</vICMS><modBCST>4</modBCST><pMVAST>72.2800</pMVAST><vBCST>1411.63</vBCST><pICMSST>17.0000</pICMSST><vICMSST>100.69</vICMSST></ICMS10></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>50</CST><vBC>795.45</vBC><pIPI>0.0000</pIPI><vIPI>0.00</vIPI></IPITrib></IPI><PIS><PISAliq><CST>01</CST><vBC>680.09</vBC><pPIS>1.6500</pPIS><vPIS>11.22</vPIS></PISAliq></PIS><COFINS><COFINSAliq><CST>01</CST><vBC>680.09</vBC><pCOFINS>7.6000</pCOFINS><vCOFINS>51.69</vCOFINS></COFINSAliq></COFINS></imposto><infAdProd>(1*) Valor Aproximado dos Tributos - R$302.89. Desconto Promocional - R$ 50,23.</infAdProd></det><det nItem=\"3\"><prod><cProd>985E10.1</cProd><cEAN>7896803077478</cEAN><xProd>SAPECA FILHOTES SC 10.1KG</xProd><NCM>23099010</NCM><CEST>2200100</CEST><EXTIPI>01</EXTIPI><CFOP>5401</CFOP><uCom>SC</uCom><qCom>15.0000</qCom><vUnCom>63.8116000000</vUnCom><vProd>957.17</vProd><cEANTrib>7896803077478</cEANTrib><uTrib>SC</uTrib><qTrib>15.0000</qTrib><vUnTrib>63.8116000000</vUnTrib><vFrete>23.93</vFrete><indTot>1</indTot></prod><imposto><vTotTrib>362.67</vTotTrib><ICMS><ICMS10><orig>0</orig><CST>10</CST><modBC>1</modBC><vBC>981.10</vBC><pICMS>17.0000</pICMS><vICMS>166.79</vICMS><modBCST>4</modBCST><pMVAST>72.2800</pMVAST><vBCST>1690.24</vBCST><pICMSST>17.0000</pICMSST><vICMSST>120.55</vICMSST></ICMS10></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>50</CST><vBC>957.17</vBC><pIPI>0.0000</pIPI><vIPI>0.00</vIPI></IPITrib></IPI><PIS><PISAliq><CST>01</CST><vBC>814.31</vBC><pPIS>1.6500</pPIS><vPIS>13.44</vPIS></PISAliq></PIS><COFINS><COFINSAliq><CST>01</CST><vBC>814.31</vBC><pCOFINS>7.6000</pCOFINS><vCOFINS>61.89</vCOFINS></COFINSAliq></COFINS></imposto><infAdProd>(1*) Valor Aproximado dos Tributos - R$362.67.</infAdProd></det><total><ICMSTot><vBC>3027.72</vBC><vICMS>514.71</vICMS><vICMSDeson>0.00</vICMSDeson><vFCP>0.00</vFCP><vBCST>5216.16</vBCST><vST>372.04</vST><vFCPST>0.00</vFCPST><vFCPSTRet>0.00</vFCPSTRet><vProd>2947.95</vProd><vFrete>79.77</vFrete><vSeg>0.00</vSeg><vDesc>0.00</vDesc><vII>0.00</vII><vIPI>0.00</vIPI><vIPIDevol>0.00</vIPIDevol><vPIS>41.47</vPIS><vCOFINS>190.99</vCOFINS><vOutro>0.00</vOutro><vNF>3399.76</vNF><vTotTrib>1119.21</vTotTrib></ICMSTot></total><transp><modFrete>0</modFrete><transporta><CNPJ>24792638000170</CNPJ><xNome>TRANSPORTADORA DE CARGAS SAO JOAO LTDA</xNome><IE>0780107713</IE><xEnder>EST. MAURICIO CARDOSO,SN - KM 08 - PASSO DA SERRA</xEnder><xMun>MONTENEGRO</xMun><UF>RS</UF></transporta><veicTransp><placa>IKB0F64</placa><UF>RS</UF></veicTransp><vol><qVol>50</qVol><esp>SC</esp><marca>SUPRA</marca><pesoL>505.000</pesoL><pesoB>511.300</pesoB></vol></transp><cobr><fat><nFat>432957</nFat><vOrig>3399.76</vOrig><vDesc>0.00</vDesc><vLiq>3399.76</vLiq></fat><dup><nDup>001</nDup><dVenc>2023-04-19</dVenc><vDup>849.97</vDup></dup><dup><nDup>002</nDup><dVenc>2023-04-26</dVenc><vDup>849.93</vDup></dup><dup><nDup>003</nDup><dVenc>2023-05-03</dVenc><vDup>849.93</vDup></dup><dup><nDup>004</nDup><dVenc>2023-05-10</dVenc><vDup>849.93</vDup></dup></cobr><pag><detPag><indPag>1</indPag><tPag>15</tPag><vPag>3399.76</vPag></detPag></pag><infAdic><infCpl>VENDA PET - ICMS RETIDO DE ACORDO COM PROTOCOLO 26/2004 - COMBINADO COM LIVRO III, ART. 177 - RICMS/RS // OPERACAO SUJEITA A NAO-INCIDENCIA DO IPI, PARA AS EMBALAGENS SUPERIORES A 10KG, EM FACE DE DECISAO TRANSITADA EM JULGADO NOS AUTOS DA ACAO DECLARATORIA NUMERO 2002.71.08.004673-4/RS / IPI NAO CALCULADO SOBRE O VALOR DO FRETE EM RAZAO DA DECISAO MANDADO DE SEGURANCA n. 500305287.2017.4.04.7108/RS. (1*) - Produto isento de registro junto ao Ministerio da Agricultura, Pecuaria e Abastecimento.</infCpl></infAdic></infNFe><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"/><SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/><Reference URI=\"#NFe43230489548523000180550100004329571176119231\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/><DigestValue>5Pn0xv9AzYUyaW+Sd/sKNgTOdW4=</DigestValue></Reference></SignedInfo><SignatureValue>Zb9fmJW+hkG2he/NJ2lV5T9EyupVeY1pcqPpQxtvV/967RYcOn16gblGtn0IsG9sEuWGVXu6BR6dK2ITmuzAu/1+/gGEAFVt8KRvNOmT/4GlVU2YMGkix+dw1YIQ87/fexyBt0CrcRsO45R4dbFC031G7RgRxXWGh2u4g1GigHwQGsff4ayDjlHNfWRY2wrFy853Ku2glFI7Zy920Mu0EDvR7LrAx+fHp/WQKPrvty0t9Z1mWYOvGFldRVOfOPIhZHMwawQIr6NHALrhHMFi+0c8ZAYBqP4z/5F3ckjHQjQ+XeBCdHceX7subS89pk+UJMUxses2OGYH3lrRn2ddZg==</SignatureValue><KeyInfo><X509Data><X509Certificate>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</X509Certificate></X509Data></KeyInfo></Signature></NFe><protNFe versao=\"4.00\"><infProt Id=\"ID143230080568074\"><tpAmb>1</tpAmb><verAplic>RS202303091530</verAplic><chNFe>43230489548523000180550100004329571176119231</chNFe><dhRecbto>2023-04-12T10:59:51-03:00</dhRecbto><nProt>143230080568074</nProt><digVal>5Pn0xv9AzYUyaW+Sd/sKNgTOdW4=</digVal><cStat>100</cStat><xMotivo>Autorizado o uso da NF-e</xMotivo></infProt></protNFe></nfeProc>";
        final String xml3 = "<nfeProc versao=\"4.00\" xmlns=\"http://www.portalfiscal.inf.br/nfe\"><NFe xmlns=\"http://www.portalfiscal.inf.br/nfe\"><infNFe Id=\"NFe52230332047181000160550010100671841001179123\" versao=\"4.00\"><ide><cUF>52</cUF><cNF>00117912</cNF><natOp>RETORNO COMB REC P/ ARMAZENAGEM</natOp><mod>55</mod><serie>1</serie><nNF>67184</nNF><dhEmi>2023-03-31T13:10:48-03:00</dhEmi><dhSaiEnt>2023-03-31T13:10:48-03:00</dhSaiEnt><tpNF>1</tpNF><idDest>1</idDest><cMunFG>5220454</cMunFG><tpImp>1</tpImp><tpEmis>1</tpEmis><cDV>2</cDV><tpAmb>1</tpAmb><finNFe>1</finNFe><indFinal>0</indFinal><indPres>1</indPres><indIntermed>0</indIntermed><procEmi>0</procEmi><verProc>petrow.com.br</verProc><NFref><refNFe>52230344297367000275550010000091821801533385</refNFe></NFref><NFref><refNFe>52230344297367000275550010000092241698760819</refNFe></NFref></ide><emit><CNPJ>33047181000160</CNPJ><xNome>DINAMICA TERMINAIS CANEDO S/A</xNome><xFant>DTC</xFant><enderEmit><xLgr>AVENIDA TROPICAL</xLgr><nro>0</nro><xCpl>QUADRAMODULO 6-B</xCpl><xBairro>DISTRITO INDUSTRIAL BRASIL CENTRAL</xBairro><cMun>5220454</cMun><xMun>SENADOR CANEDO</xMun><UF>GO</UF><CEP>75251722</CEP><cPais>1058</cPais><xPais>BRASIL</xPais><fone>6235122932</fone></enderEmit><IE>107550547</IE><CRT>3</CRT></emit><dest><CNPJ>44297367000275</CNPJ><xNome>WK PRODUTOS DE PETROLEO LTDA</xNome><enderDest><xLgr>AVENIDA TROPICAL</xLgr><nro>0</nro><xBairro>DISTRITO INDUSTRIAL BRASIL CENTRAL</xBairro><cMun>5220454</cMun><xMun>SENADOR CANEDO</xMun><UF>GO</UF><CEP>75251722</CEP><cPais>1058</cPais><xPais>BRASIL</xPais><fone>6233071595</fone></enderDest><indIEDest>1</indIEDest><IE>109208153</IE><email>wkcombustiveis@gropowk.net.br</email></dest><det nItem=\"1\"><prod><cProd>58/S10 A</cProd><cEAN>SEM GTIN</cEAN><xProd>S10 A 420105001</xProd><NCM>27101921</NCM><CFOP>5664</CFOP><uCom>L</uCom><qCom>2249</qCom><vUnCom>4.9218008004</vUnCom><vProd>11069.13</vProd><cEANTrib>SEM GTIN</cEANTrib><uTrib>L</uTrib><qTrib>2249</qTrib><vUnTrib>4.9218008004</vUnTrib><indTot>1</indTot><comb><cProdANP>420105001</cProdANP><descANP>OLEO DIESEL A S10</descANP><UFCons>GO</UFCons></comb></prod><imposto><ICMS><ICMS40><orig>0</orig><CST>41</CST></ICMS40></ICMS><IPI><cEnq>004</cEnq><IPINT><CST>54</CST></IPINT></IPI><PIS><PISNT><CST>09</CST></PISNT></PIS><COFINS><COFINSNT><CST>09</CST></COFINSNT></COFINS></imposto><infAdProd>NFE52230344297367000275550010000092241698760819 9.224/1 28/03/2023 TA: 21,0 DA: 0,8345 D20: 0,8352 FC: 0,9992</infAdProd></det><det nItem=\"2\"><prod><cProd>68/B100</cProd><cEAN>SEM GTIN</cEAN><xProd>BIODIESEL 820101001</xProd><NCM>38260000</NCM><CFOP>5664</CFOP><uCom>L</uCom><qCom>250</qCom><vUnCom>4.6382400000</vUnCom><vProd>1159.56</vProd><cEANTrib>SEM GTIN</cEANTrib><uTrib>L</uTrib><qTrib>250</qTrib><vUnTrib>4.6382400000</vUnTrib><indTot>1</indTot><comb><cProdANP>820101001</cProdANP><descANP>BIODIESEL B100</descANP><UFCons>GO</UFCons></comb></prod><imposto><ICMS><ICMS40><orig>0</orig><CST>41</CST></ICMS40></ICMS><IPI><cEnq>004</cEnq><IPINT><CST>54</CST></IPINT></IPI><PIS><PISNT><CST>09</CST></PISNT></PIS><COFINS><COFINSNT><CST>09</CST></COFINSNT></COFINS></imposto><infAdProd>NFE52230344297367000275550010000091821801533385 9.182/1 27/03/2023 TA: 21,0 DA: 0,8776 D20: 0,8781 FC: 0,9992</infAdProd></det><total><ICMSTot><vBC>0.00</vBC><vICMS>0.00</vICMS><vICMSDeson>0.00</vICMSDeson><vFCPUFDest>0.00</vFCPUFDest><vICMSUFDest>0.00</vICMSUFDest><vICMSUFRemet>0.00</vICMSUFRemet><vFCP>0.00</vFCP><vBCST>0.00</vBCST><vST>0.00</vST><vFCPST>0.00</vFCPST><vFCPSTRet>0.00</vFCPSTRet><vProd>12228.69</vProd><vFrete>0.00</vFrete><vSeg>0.00</vSeg><vDesc>0.00</vDesc><vII>0.00</vII><vIPI>0.00</vIPI><vIPIDevol>0.00</vIPIDevol><vPIS>0.00</vPIS><vCOFINS>0.00</vCOFINS><vOutro>0.00</vOutro><vNF>12228.69</vNF><vTotTrib>0.00</vTotTrib></ICMSTot></total><transp><modFrete>4</modFrete><transporta><CNPJ>44297367000275</CNPJ><xNome>WK PRODUTOS DE PETROLEO LTDA</xNome><IE>109208153</IE><xEnder>AVENIDA TROPICAL, S/N  DISTRITO INDUSTRIAL BRASIL CENTRAL</xEnder><xMun>SENADOR CANEDO</xMun><UF>GO</UF></transporta><veicTransp><placa>FRI3C57</placa></veicTransp><vol><qVol>2499</qVol><esp>GRANEL</esp><marca>DTC</marca><pesoL>2097.890</pesoL><pesoB>2097.890</pesoB></vol></transp><pag><detPag><indPag>0</indPag><tPag>90</tPag><vPag>0.00</vPag></detPag></pag><infAdic><infCpl>DECLARAMOS QUE OS PRODUTOS ESTAO ADEQUADAMENTE EMBALADOS/ACONDICIONADOS P/ SUPORTAR OS RISCOS DE CARREGAMENTO, DESCARREGAMENTO, TRANSBORDO E TRANSPORTE, CONFORME REGULAMENTACAO EM VIGOR. NAO INCIDENCIA DE ICMS, CONF. DEC. 4852/97, ART. 79, INC. I, ALINEA I RCTE-SEFAZ-GO.|002.515-03 FRI3C57 ERONICE 31/03/23</infCpl></infAdic><infRespTec><CNPJ>25337354000157</CNPJ><xContato>EVERTON ANTONIO RAMOS</xContato><email>everton@txfuel.com.br</email><fone>41991341456</fone></infRespTec></infNFe><Signature xmlns=\"http://www.w3.org/2000/09/xmldsig#\"><SignedInfo><CanonicalizationMethod Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"/><SignatureMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#rsa-sha1\"/><Reference URI=\"#NFe52230333047181000160550010000671841001179122\"><Transforms><Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/><Transform Algorithm=\"http://www.w3.org/TR/2001/REC-xml-c14n-20010315\"/></Transforms><DigestMethod Algorithm=\"http://www.w3.org/2000/09/xmldsig#sha1\"/><DigestValue>Gl2d7APkqcG4yWb3DNE8/biib7I=</DigestValue></Reference></SignedInfo><SignatureValue>M5oNfVMhNTv7iGf9XZ78IQHGPKqluwzm02aF46Lu/TNSEkmDf/f++Hq3OOkzuHoKnIpViGYn7WZ7c5fGg8xGa4HEd/dU20bjDIrGmLX5VjknNeUD+0Vrv5gnokDl/T3GCa029R4jkAaaFBlD56uKdvAuc4UdoY7naMfXKyshfrTK3ojQIf5rh4lk8ocn73Ak4mfkvmIX4UhHQ8GDACRBTzYogvRiYdNprTq/U24h+xAjkuG2TMasZoit8sEKlfPVYVKIjeLgrVMk3r1lqLhHez419H6ULpAxi2zHLpIO/O8TyEDHbwpuhcjzdKWciEBcX9X1tqNi9qTxa/WX1/eWWw==</SignatureValue><KeyInfo><X509Data><X509Certificate>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</X509Certificate></X509Data></KeyInfo></Signature></NFe><protNFe versao=\"4.00\"><infProt Id=\"NFe00\"><tpAmb>1</tpAmb><verAplic>GO4.0</verAplic><chNFe>52230333047181000160550010000671841001179122</chNFe><dhRecbto>2023-03-31T13:10:51-03:00</dhRecbto><nProt>152236143080702</nProt><digVal>Gl2d7APkqcG4yWb3DNE8/biib7I=</digVal><cStat>100</cStat><xMotivo>Autorizado o uso da NF-e</xMotivo></infProt></protNFe></nfeProc>";

        final Validar validar = new Validar();

        assertEquals(true, validar.isValidXml("schemas", xml1, ServicosEnum.PROC));
        assertEquals(true, validar.isValidXml("schemas", xml2, ServicosEnum.PROC));
        assertEquals(true, validar.isValidXml("schemas", xml3, ServicosEnum.PROC));
    }

    @Test
    void leXmlCorreto() throws IOException {
        String xml = XmlNfeUtil.leXml("src/test/resources/TesteLeXml.xml");
        assertEquals("<teste>\n    <tag>123</tag>\n</teste>", xml);
    }

    @Test
    void leXmlArquivoNaoExiste() {
        String arquivo = "TesteLeXml.xml";
        FileNotFoundException exception = assertThrows(FileNotFoundException.class, () -> {
            String xml = XmlNfeUtil.leXml(arquivo);
        });
        assertEquals(exception.getMessage(), "Arquivo " + arquivo + " não encontrado.");
    }

    @Test
    void leXmlParametroVazioNull() {
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () -> {
            String xml = XmlNfeUtil.leXml(null);
        });
        assertEquals(exception.getMessage(), "Arquivo xml não pode ser nulo/vazio.");

        exception = assertThrows(IllegalArgumentException.class, () -> {
            String xml = XmlNfeUtil.leXml("");
        });
        assertEquals(exception.getMessage(), "Arquivo xml não pode ser nulo/vazio.");
    }

    @Test
    void geraHashCSRTSucesso() throws NoSuchAlgorithmException {
        String chave = "41180678393592000146558900000006041028190697";
        String csrt = "G8063VRTNDMO886SFNK5LDUDEI24XJ22YIPO";

        assertArrayEquals("aWv6LeEM4X6u4+qBI2OYZ8grigw=".getBytes(StandardCharsets.UTF_8), XmlNfeUtil.geraHashCSRT(chave, csrt));
    }

    @Test
    void geraHashCSRTParametrosInvalidos() {
        String chave = "41180678393592000146558900000006041028190697";
        String csrt = "G8063VRTNDMO886SFNK5LDUDEI24XJ22YIPO";

        //Chave Nula
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, ()
                -> XmlNfeUtil.geraHashCSRT(null, csrt)
        );
        assertEquals(exception.getMessage(), "Chave não deve ser nula ou vazia");

        //Chave Com menos Caracteres
        exception = assertThrows(IllegalArgumentException.class, ()
                -> XmlNfeUtil.geraHashCSRT("123", csrt)
        );
        assertEquals(exception.getMessage(), "Chave deve conter 44 caracteres.");

        //CSRC Vazio
        exception = assertThrows(IllegalArgumentException.class, ()
                -> XmlNfeUtil.geraHashCSRT(chave, "")
        );
        assertEquals(exception.getMessage(), "CSRT não deve ser nulo ou vazio");
    }

}
